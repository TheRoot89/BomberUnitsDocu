<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BomberUnits: How to create state machines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Dunny.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BomberUnits
   </div>
   <div id="projectbrief">...a Unity learning project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_how_to_create_state_machines.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">How to create state machines </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>How to create State Machines (using the Unity Animator System) </h1>
<h2>In general </h2>
<div class="image">
<img src="State_machine_example.png" alt="State_machine_example.png"/>
<div class="caption">
Example state machine</div></div>
<ul>
<li>A state machine is used to represent the states a particular object or system may be in, with one being the current state at any given time.<br />
 Examples: a simple enemy AI, menu page transitions or states of the game.</li>
<li>Taken together, the set of states, the set of transitions between them and the variable to remember the current state form the state machine.</li>
<li>In Unity, you can create an asset called an Animator Controller. This is a state machine template normally used for transition between different object or character animations.</li>
<li>The state machine states are usually associated to animations, but this is actually optional if you want to create a pure-logic state machine.</li>
<li>To run your state machine, add a component called Animator to a GameObject and set it up with any Animator Controller that you’ve created. This is now an instance of your state machine.</li>
<li>To run logic on each state, you need to create a script derived from the class StateMachineBehaviour. This script can be added to a state in the state machine (Animator) view.</li>
</ul>
<h2>StateMachineBehaviour </h2>
<ul>
<li>Use <code>OnStateEnter()</code> and <code>OnStateExit()</code> methods to e.g. start and stop listening to game events when the state is active.</li>
<li>To clean up the current state properly, you’ll need to make sure to handle <code>OnDisable()</code> as well, as the above callbacks are not called if the object or Animator component is disabled.</li>
<li>You can create a library of StateMachineBehaviour subclasses to reuse in your state machines.</li>
</ul>
<h2>Settings it up </h2>
<ol type="1">
<li>Create a new "Animator Controller" from the right-click menu. A double-click on it will bring you to the Animator Editor view, showing the first state boxes: Start and Exit.</li>
<li>Create the state boxes you need and draw the desired connections using right-click-&gt;make transition.</li>
<li>For each transition, set transition duration to zero and deactivate the exit time. If transition duration is non-zero, the next state’s OnEnter will be called before the current state’s OnExit and both are active at the same time! (This is the intended function of the transition between to animation states: a blend- over between the two.)</li>
<li>Add transition Triggers in the parameter sidebar and assign them as conditions to the transitions you created. A logical 'Or' is done by adding more than one transition between the same source and target. A logical 'And' is done by having multiple conditions on a single transition.</li>
<li>Add your Controller to an Animator component of a suitable object of your choice. Example: A GameState state machine would go to the 'GameManager' persistent object.</li>
<li>Get the Animator component, which represents the State Machine from your script. You may want to wrap this in your own StateMachine type class.</li>
<li>Call <code>SetTrigger("Trigger name")</code> from code on that controller object to enable the transitions.</li>
<li>Add subclasses of StateMachineBehaviours to individual states of the machine. As explained above, these possess Callbacks, which are called from Unity when the relevant state is entered or exited. This mechanism works very much like the 'normal' MonoBehaviours you are probably used to.</li>
</ol>
<h2>Notes </h2>
<ul>
<li>Do not trigger transitions more than once, because they are only consumed once per frame!</li>
<li>Transitions using triggers will advance to the next state in the same frame. Transitions based on other parameter types take an extra frame.</li>
</ul>
<h2>Links </h2>
<ul>
<li><a href="https://medium.com/the-unity-developers-handbook/dont-re-invent-finite-state-machines-how-to-repurpose-unity-s-animator-7c6c421e5785">Article on this</a></li>
</ul>
<p>Maybe have a look at some alternatives:</p>
<ul>
<li><a href="https://assetstore.unity.com/packages/tools/visual-scripting/xnode-104276">xNode</a></li>
<li><a href="https://assetstore.unity.com/packages/3d/characters/animator-state-machine-utility-23450">Animator State Machine Utility</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="page_howtos.html">How-Tos</a></li>
    <li class="footer">Generated on Tue Oct 29 2019 06:06:59 for BomberUnits by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
