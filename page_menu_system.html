<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BomberUnits: Menu page System</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Dunny.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BomberUnits
   </div>
   <div id="projectbrief">...a Unity learning project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_menu_system.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Menu page System </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>The menu page system </h1>
<p>The menu page system is intended to provide animations for menu components as well as grouping, but still preserve the Unity Layout features etc. The classic approach is having multiple full menu "pages" readily set up with all their children on the canvas at the same time. These would then be made visible or invisible as pages are switched. We instead want to be able to animate and pan into view the individual elements (often panels with buttons and images) independently. By parenting, also full pages can be animated with this of course.</p>
<h2>Basics </h2>
<p>An animation is saved as its own file (*.anim), which describes the transition of controlled parameters(e.g. its position) over time. Each animation can be viewed as a state an object is in with transitions between different animations. These transitions can be done abruptly or smoothly, which is what we use here.</p>
<p>The <em>Animator</em> component is added to an object that shall be animated. It gets assigned an <em>Animation Controller</em> to organize in a state-machine fashion when which series of animations is applied to an object. Each animated object has its own animation state machine it runs through. The Animation Controller also defines how the different animations aka <em>states</em> transition (<em>blend over</em>) into each other.</p>
<h2>The System </h2>
<p>Have a look at the test scene: Assets/Scenes/Tests/MenuAnimationWithLayoutsTest.unity</p>
<ul>
<li>We have 5 animations: one for each state of being <em>hidden</em> to each of the four sides of the screen, and one for being centered aka. <em>shown</em> on the canvas (i.e. a position of (0,0,0) ).</li>
<li>Each "animation" only consists of one frame: the new position of the object shall have. The actual visible animation of an element sliding out or in is actually the visible transition between those 1-frame-animations.</li>
<li>Each item to be animated also needs the <code>UIMenuElement</code> component, which features the scripting to start the animations and provides necessary settings.</li>
<li>UIMenuElements can be grouped to form a <code>UIMenuPage</code>, by listing these elements on an empty object featuring the <code>UIMenuPage</code> component. They do not have to be children of the page, but only be listed there! This allows for reuse of elements on multiple pages.</li>
<li>The pages can be children of a 'Pages' parent but don't have to be.</li>
</ul>
<p><em>Elements</em> and <em>Pages</em> provide functions to hide or show them. Have a look at their documentation for details.</p>
<h2>Application to the project </h2>
<p>The concrete menus may be found in the GDD under the Doc folder.</p>
<h2>Coping with Layouts </h2>
<p>Layouts, together with anchors, are very useful calculating the correct sizing and positioning for all objects automatically. But Layouts also prevent objects from moving, i.e. being animated with a shift because they have control over the position (the coordinates are greyed-out). As a solution, we need to layout an invisible parent of the object-to-be-animated and shift the actual element relative to its parent.</p>
<p>So, to get both worlds, set the the content you want to animate as child of an empty RectTransform object. This <em>container</em> will get layed out by its respective parent having a layout component. The actual <code>UIMenuElement</code> in its shown state is set to be in relative position (0,0) and is thus the same as its container. This relative position can be modified by the Animator to move off-screen, while the container actually stays in place as set by the layout.</p>
<h2>How to set it up </h2>
<ol type="1">
<li>Have some object, such as a <code>UIManager</code> to organize the logics between page transitions. It decides <em>which</em> menu components should switch <em>when</em>. Also menu button setup etc. has to be done here when switching between pages.</li>
<li>Do the usual Layout with the Unity System:<ul>
<li>Versions of <em>Layout Group</em> components are added to the parents of groups of objects to be layed out.</li>
<li>Think about using <em>Layout Element</em> components for these elements to be able to set minimum dimensions. This way eventual parent Layout groups of this element do not change to much when it's content is moved out and disabled by our animations.</li>
<li>Example in the test scene: <code>MainHLayout</code></li>
</ul>
</li>
<li>Elements you want to animate and which are part of a Layout group need an empty and invisible container object, which is only a Rect Transform.<ul>
<li>Example in the test scene: <code>Element3LayoutContainer</code></li>
</ul>
</li>
<li>The elements itself, such as <code>Element3</code>, need the <code>Animator</code> and <code>UIMenuElement</code> components.</li>
<li>Give the <code>Animator</code> component the <code>MenuElementTransition</code> Controller.</li>
<li>Assign the container object to the <code>UIMenuElement</code>'s <em>Container</em> field if any. This is needed so the container can be disabled when the element is disabled. This will change the organization of the enclosing <em>Layout Group</em>, so don't give a reference to the container if you don't want it to be disabled when the element is hidden.</li>
<li>Assign groups of elements to animate together to the "Page Elements" fields of empty objects with the <code>UIMenuPage</code> component. These represent your menu pages and can be used in your UI manager's button callbacks to call to switch pages. You should group your logical pages under its own parent, e.g. <em>Pages</em>.<ul>
<li>Hint: The page inspector provides a toggle to show or hide the page GameObject while editing, which should be handy.</li>
</ul>
</li>
<li>Handle your menu transitions with your own button callbacks on your UI Manager. Some convenience functions are also available for pages and elements directly, so you can assign these to your button's callbacks directly, without doing an extra UI-manager-detour.</li>
</ol>
<p>Note: Regarding page transitions, have a look at <a class="el" href="page_ui_states.html">UI State System</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="page_concepts.html">Concepts</a></li>
    <li class="footer">Generated on Tue Sep 24 2019 22:35:37 for BomberUnits by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
